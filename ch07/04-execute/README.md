# 도커 컴포즈 실행
## 컨테이너와 주변 환경을 생성하는 `docker-compose up`
```docker
# 시작
docker compose -f 정의_파일_경로 up 옵션
```
### 시작 옵션
|옵션|내용|
|---|---|
|-d|백그라운드로 실행|
|--no-color|화면 출력 내용을 흑백으로 함|
|--no-deps|링크된 서비스를 실행하지 않음|
|--force-recreate|설정 또는 이미지가 변경되지 않더라도 컨테이너를 재생성|
|--no-create|컨테이너가 이미 존재할 경우 다시 생성하지 않음|
|--no-build|이미지가 없어도 이미지를 빌드하지 않음|
|--build|컨테이너를 실행하기 전에 이미지를 빌드|
|--abort-on-container-exit|컨테이너가 하나라도 종료되면 모든 컨테이너를 종료|
|-t, --timeout|커넽이너를 종료할 때의 타임아웃 설정. 기본은 10초|
|-remove-orphans|컴포즈 파일에 정의도지 않은 서비스 컨테이너를 삭제|
|--scale|컨테이너의 수를 변경|

## 컨테이너와 네트워크를 삭제하는 `docker-compose down`
```docker
# 종료
docker compose -f 정의_파일_경로 down
```
### 종료 옵션
|옵션|내용|
|---|---|
|-rmi `종류`|삭제 시에 이미지도 삭제<br>종류를 `all`로 지정하면 사용했던 모든 이미지가 삭제된다.<br> `local`로 지정하면 커스텀 태그가 없는 이미지만 삭제|
|-v, --volumes|volumes 항목에 기재된 볼륨을 삭제 단, `external`로 지정된 볼륨은 삭제되지 않는다.|
|--remove-orphans|컴포즈 파일에 정의되지 않은 서비스의 컨테이너도 삭제|

## 컨테이너를 종료하는 `docker-compose stop`
```docker
docker compose -f 컴포즈_파일_경로 stop 옵션
```

## 그 밖에 주요 커맨드 목록
|커맨드|내용|
|---|---|
|`up`|컨테이너를 생성하고 실행|
|`down`|컨테이너와 네트워크를 종료하고 삭제|
|ps|컨테이너 목록을 출력|
|config|컴포즈 파일을 확인하고 출력|
|port|포트 설정 내용을 출력|
|logs|컨테이너가 출력한 내용을 화면에 출력|
|start|컨테이너를 시작|
|`stop`|컨테이너를 종료|
|kill|컨테이너를 강제 종료|
|exec|명령어를 실행|
|run|컨테이너를 실행|
|create|컨테이너를 생성|
|restart|컨테이너를 재실행|
|pause|컨테이너를 일시정지|
|unpause|컨테이너 일시정지 해제|
|rm|종료된 컨테이너를 삭제|
|pull|컨테이너에 사용되는 이미지를 내려받음|
|events|컨테이너로부터 실시간으로 이벤트를 수신|

## 옵션 (재확인 필요)
|옵션|내용|
|---|---|
|--build|컨테이너에 사용되는 이미지를 빌드 혹은 재빌드|
|--scale|컨테이너의 수를 지정|
|--help|도움말 화면을 출력|

## Tip
- 도커 컴포즈를 사용할 때 명령 프롬프트나 터미널에서 현재 작업 디렉터리를 컴포즈용 폴더로 사용할 때는 컴포즈 파일을 따로 지정하지 않아도 된다.
- 그러나 이 때 파일 이름은 반드시 `docker-compose.yml`이어야 한다.
    ```shell
    cd 컴포즈_폴더경로
    docker compose up -d
    ```
## 주의 사항
- 도커 컴포즈로 실행한 컨테이너의 이름은 임의로 결정된다.
    - ex) 03-configuration/docker-compose.yml을 실행하면 컴포즈 내 서비스 이름에 숫자가 붙는다.
    - 까다로운 부분은, 컨테이너 이름에 폴더 이름이나 번호가 부어도 도커 컴포즈를 통해 컨테이너를 지정할 때는 컴포즈 파일에 기재된 원래 이름을 사용할 수도 있다.
    - 이렇게 번호가 붙어 지정된 컨테이너 이름은 도커 엔진을 통해 컨테이너를 관리하거나, 같은 구성의 컨테이너를 여러 세트 실행했을 때도 사용된다.
    - *도커 컴포즈 자신은 (평소에)사용하지 않으면서 도커 엔진에게는 바뀐 이름을 쓰게하는 점이 흥미롭다..*
    - 따라서 도커 엔진을 통해 컨테이너를 다룰 때는 `ps` 커맨드를 사용해 먼저 컨테이너의 실제 이름을 확인해야한다.
- 같은 구성의 컨테이너를 여러 세트 만들고 싶다면 `up` 커맨드에 `--scale` 옵션을 사용한다. 그러나 자주 사용하진 않지만, 쿠버네티스에 비해 간단하다.
    ```docker
    # mysql000ex11 컨테이너를 5개 실행하기
    docker compose -f docker-compose.ex2.yml up -d --scale mysql000ex11=5
    ```